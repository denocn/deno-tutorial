<!doctype html><html class="" data-reactroot=""><head><script async="" src="https://www.google-analytics.com/analytics.js"></script><script>
            window.GoogleAnalyticsObject="ga";(window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments);}),(window.ga.l=1*new Date());

            ga('create', 'UA-169223577-1', 'auto');
            ga('send', 'pageview');</script><link rel="icon" type="image/png" href="/favicon.png"/>
<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="description" content="循序渐进学 Deno &amp; 先易后难补 Node &amp; 面向未来的 Deno Web 应用开发。"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/>
<title data-react-helmet="true">如何在 Deno 下使用 AlpehJS 库构建 React 应用 · Deno 钻研之术</title>
<link data-react-helmet="true" rel="stylesheet" href="/assets/index.css"/><link data-react-helmet="true" id="prismTheme" rel="stylesheet" href="/assets/prism.css"/>
<script data-react-helmet="true" >
    const shouldSetIsDark = document.cookie.includes('is_dark=1') ? true : document.cookie.includes('is_dark=0') ? false : window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (shouldSetIsDark) {
      document.documentElement.classList.add('is_dark');
      document.getElementById('prismTheme').href = "/assets/prism_tomorrow.css";
    }
  </script>
</head><body><header><h1 class="hide_on_mobile"><a href="/">Deno 钻研之术</a></h1><nav><ul><li class="show_on_mobile flex_center"><a class="czs-menu-l" href="#" style="background-image:url(&quot;/assets/czs-menu-l.svg&quot;)"></a></li><li class="show_on_mobile"><h1 class="mobile_title"><a href="/">Deno 钻研之术</a></h1></li><li class="hide_on_mobile"><a href="/articles/">文章</a></li><li class="hide_on_mobile"><a href="http://qiniu.ningo.cloud/hylerrix/reward-alipay.png" target="_blank">打赏一下!!</a></li><li class="hide_on_mobile"><a href="https://github.com/hylerrix/awesome-deno-cn" target="_blank">资源</a></li><li class="hide_on_mobile"><a href="http://tutorial.deno.js.cn" target="_blank">镜像</a></li><li class="hide_on_mobile"><a href="https://github.com/hylerrix/blitzjs-tutorial" target="_blank">Blitz.js + React 全栈开发手册</a></li><li class="hide_on_mobile"><a href="https://github.com/hylerrix" target="_blank">持续添加中...</a></li><li class="hide_on_mobile"><a href="https://github.com/ningowood" target="_blank">凝果屋</a></li><li class="hide_on_mobile"><a href="https://github.com/hylerrix" target="_blank">关于</a></li><li style="flex-grow:1"></li><li class="flex_center"><a class="czs-github-logo" href="https://github.com/hylerrix/deno-tutorial" target="_blank" style="background-image:url(&quot;/assets/czs-github-logo.svg&quot;)"></a></li><li class="toggle_dark flex_center"><span class="czs-sun" style="background-image:url(&quot;/assets/czs-sun.svg&quot;)"></span><span class="czs-sun-l" style="background-image:url(&quot;/assets/czs-sun-l.svg&quot;)"></span><span class="czs-moon" style="background-image:url(&quot;/assets/czs-moon.svg&quot;)"></span><span class="czs-moon-l" style="background-image:url(&quot;/assets/czs-moon-l.svg&quot;)"></span></li></ul></nav></header><aside class="sidebar"><ol class="list_style_none"><li class=""><a href="/articles/index.html" class="nav_link">Deno 钻研之术</a></li><li class="unfold"><a href="/articles/document/index.html" class="nav_link">文档篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/document/deno-version-handbook.html" class="nav_link">Deno 版本历史概览</a></li><li class=""><a href="/articles/document/deno-cli-handbook.html" class="nav_link">Deno CLI 通用手册</a></li><li class=""><a href="/articles/document/deno-translation-dictionary.html" class="nav_link">Deno 专业术语翻译手册</a></li></ol></li><li class="unfold"><a href="/articles/basic/index.html" class="nav_link">基础篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/basic/install-and-hello-world.html" class="nav_link">Hello，从多样化安装到简单实战</a></li></ol></li><li class="unfold"><a href="/articles/architecture/index.html" class="nav_link">架构篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class="unfold"><a href="/articles/architecture/cli/index.html" class="nav_link">CLI 篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/architecture/cli/deno-cli-v1-function.html" class="nav_link">从 CLI 指令通读 Deno v1.x 全特性</a></li></ol></li></ol></li><li class="unfold"><a href="/articles/ecology/index.html" class="nav_link">生态篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/ecology/awesome-deno-cn.html" class="nav_link">Awesome Deno 中文资源全图谱</a></li></ol></li><li class="unfold"><a href="/articles/official/index.html" class="nav_link">官方篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/official/thoroughgoing-deno-in-2020.html" class="nav_link">精读《Deno 2020 官方回顾及 2021 展望》</a></li><li class=""><a href="/articles/official/thoroughgoing-deno-1-8.html" class="nav_link">精读《Deno v1.8 发布说明》</a></li><li class=""><a href="/articles/official/translate-deno-1-9.html" class="nav_link">译《Deno v1.9 发布说明》</a></li></ol></li><li class="unfold"><a href="/articles/translation/index.html" class="nav_link">翻译篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/translation/the-deno-handbook.html" class="nav_link">Deno 入门手册：附大量 TypeScript 代码实例</a></li><li class=""><a href="/articles/translation/deno-chat-app.html" class="nav_link">Deno + WebSockets 打造聊天室应用</a></li><li class=""><a href="/articles/translation/from-node-to-deno.html" class="nav_link">从 Node 到 Deno：探索各大主流库替代方案</a></li><li class=""><a href="/articles/translation/deno-oak-todo-api.html" class="nav_link">Deno + Oak 构建酷炫的 Todo API</a></li><li class=""><a href="/articles/translation/deno-oak-mysql.html" class="nav_link">Deno + Oak 连接 MySQL 实战教程</a></li><li class=""><a href="/articles/translation/why-deno-wrong.html" class="nav_link">为什么我认为 Deno 是一个迈向错误方向的 JavaScript 运行时？</a></li><li class=""><a href="/articles/translation/why-deno-flopped.html" class="nav_link">为什么 Deno 没有众望所归？超越 Node.js 还要做些什么？</a></li><li class=""><a href="/articles/translation/deno-url-shortener.html" class="nav_link">如何在 Deno 中构建一个 URL 短链生成器</a></li><li class=""><a href="/articles/translation/deno-alpeh-react.html" class="nav_link active">如何在 Deno 下使用 AlpehJS 库构建 React 应用</a></li></ol></li><li class="unfold"><a href="/articles/rust/index.html" class="nav_link">Rust 篇<span class="czs-angle-up-l" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></span><span class="czs-angle-down-l" style="background-image:url(&quot;/assets/czs-angle-down-l.svg&quot;)"></span></a><ol class="list_style_none"><li class=""><a href="/articles/rust/rust-tutorial-todo-app.html" class="nav_link">Rust 语言入门教程：从实战 To-Do App 开始</a></li></ol></li><li class=""><a href="/articles/TIMELINE.html" class="nav_link">开发日志</a></li><li class=""><a href="/articles/THANKS.html" class="nav_link">感谢</a></li></ol></aside><section class="main"><div class="main_article"><article><h1>如何在 Deno 下使用 AlpehJS 库构建 React 应用</h1>
<blockquote>
<ul>
<li>原文地址：<a href="https://www.freecodecamp.org/news/build-react-app-using-deno-and-alephjs/">How to Build React Applications with Deno Using the AlephJS Library</a></li>
<li>原文作者：Akash Joshi</li>
<li>原文发布时间/翻译时间：20210312/20210429</li>
<li>译者：<a href="https://github.com/hylerrix">hylerrix</a></li>
<li>备注：本文遵循 <a href="https://github.com/freeCodeCamp/news-translation">freeCodeCamp 翻译规范</a>，同时本文会收录在<a href="https://github.com/hylerrix/deno-tutorial">《Deno 钻研之术》</a>的翻译篇中。</li>
</ul>
</blockquote>
<p>如果你是刚刚开始使用 Deno 的前端开发人员，你可能会像知道，你是否可以使用 Deno 构建像 NextJS 或 create-react-app（CRA）应用程序一样复杂的东西？</p>
<p>我最近在想同样的事情。我想尝试使用能提供高共享性的 Deno，其能够直接从 URL 运行 JavaScript 和 TypeScript 应用程序。同时 Deno 编译器支持从 URL 中导入模块，从而实现了更大的可移植性。</p>
<p>我查阅了线上是否有任何相应的解决方案，但我只先找到了<a href="https://dev.to/adriantwarog/react-deno-server-side-rendering-with-deno-ssr-4438">这篇文章</a>，它使用了一些复杂的技术构建了一个 SSR 的 React 应用程序。复杂得并不简单，不像 NextJS 或 CRA 那样入门友好。</p>
<p>所以，通过更多的查阅，我最终找到了 AlephJS 框架，有着相比之前最酷的主页。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/gif/86548/1619653831303-b973d071-5cd0-447b-8420-8f8fde1764dd.gif#height=1200&amp;id=DBhf1&amp;originHeight=1200&amp;originWidth=2460&amp;originalType=binary&amp;size=0&amp;status=done&amp;style=none&amp;width=2460" alt=""></p>
<p>与 NextJS 一样，Aleph 是一个零配置，由 TypeScript 驱动的 React 框架。唯一的缺点是 Aleph 仍然处于 Alpha 状态。</p>
<p>因此，让我们开始使用 AlephJS，来在 Deno 中获得真正的类似于 Next 的 React 体验。它具有 Next 相同的许多约定，例如：</p>
<ul>
<li>一个 <code>/pages</code> 目录用来创建 URL 路由</li>
<li>pages 中直接支持 <code>.js .jsx .ts .tsx</code> 格式。</li>
<li>一个 <code>/public</code> 目录用来存放静态资源比如视频、音频或图片文件。</li>
<li>一个 /pages/api 目录用来存放 JavaScript 或 TypeScript 的 serverless APIs。</li>
</ul>
<h2 id="%E5%A6%82%E4%BD%95%E4%BB%8E-alephjs-%E5%BC%80%E5%A7%8B">如何从 AlephJS 开始<a class="anchor" href="#%E5%A6%82%E4%BD%95%E4%BB%8E-alephjs-%E5%BC%80%E5%A7%8B">§</a></h2>
<p>为了能够使用到 AlephJS，你需要确保你已安装了 Deno。你可以在我<a href="https://www.freecodecamp.org/news/build-a-url-shortener-in-deno/">之前的这篇文章中</a>查看如何安装 Deno。</p>
<p>准备好后，你需要先通过如下命令安装 Aleph CLI：</p>
<pre class="language-bash"><code class="language-bash">deno <span class="token function">install</span> -A -f -n aleph <a class="token url-link" href="https://deno.land/x/aleph@v0.3.0-alpha.1/cli.ts">https://deno.land/x/aleph@v0.3.0-alpha.1/cli.ts</a>
</code></pre>
<p>安装完后，你可以运行 <code>aleph -h</code> 来检查是否安装成功。</p>
<p>由于 Deno 的 URL 特性，你可以使用 <code>deno run -A [https://deno.land/x/aleph@v0.3.0-alpha.1/cli.ts](https://deno.land/x/aleph@v0.3.0-alpha.1/cli.ts) start $app_URI</code> 替换 aleph 来执行任何命令，并且无需本地安装 CLI 即可运行 Aleph 程序。</p>
<p>运行如下命令来初始化一个应用：</p>
<pre class="language-bash"><code class="language-bash">aleph init hello
<span class="token builtin class-name">cd</span> hello
</code></pre>
<p>然后使用 <code>aleph dev</code> 在开发模式下启动该应用，以在端口 <code>8080</code> 上启动服务器。</p>
<p>要以生产模式启动该应用程序，你必须首先 <code>build</code> 构建该应用程序。你可以通过以下命令执行此操作：</p>
<pre class="language-bash"><code class="language-bash">aleph build <span class="token comment"># build your app</span>
aleph start <span class="token comment"># runs built app</span>
</code></pre>
<p>在你初始化完毕 Aleph 之后，你会发现根组件已经在 <code>pages/index.tsx</code> 中定义了。这是正常的 React 组件。你可以对其进行修改，以了解 Aleph 的工作原理。</p>
<p>你也可以通过在 <code>pages</code> 文件夹中创建更多 <code>.jsx</code> 或 <code>.tsx</code> 文件来向应用添加更多的路由。你可以<a href="https://alephjs.org/docs/basic-features/routing">在此处</a>阅读有关 Aleph 中路由的更多知识。</p>
<h2 id="%E5%A6%82%E4%BD%95%E5%9C%A8-deno-%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%BA%93">如何在 Deno 中导入库<a class="anchor" href="#%E5%A6%82%E4%BD%95%E5%9C%A8-deno-%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%BA%93">§</a></h2>
<p>我之前在 freeCodeCamp 中写过有关 Deno 的文章，其中演示了一些 Deno 的基础知识，比如 URL 的导入。由于 Aleph 是 Deno 框架，因此所有导入均以“Deno 的方式”进行。</p>
<p>你可以在 Deno 应用程序中导入这两种库：</p>
<ol>
<li>Importing Deno-Native Libraries: These libraries were either built for Deno, or ported over from npm to support Deno usage.</li>
<li>导入 Deno 原生库：这些库要么是为 Deno 构建的，要么是从 npm 移植过来的，均支持 Deno 的使用。</li>
<li>从 NPM 中导入：如果你最近使用过 JS，则很可能了解 npm。不了解的话：npm（node 包管理器背后的公司）是所有 JavaScript 库的一种标准托管库。幸运的是，Deno 对 npm 库有一定限度的支持。可以使用诸如 <a href="http://esm.sh/">esm.sh</a> 或 skypack.dev 这样的工具，用户可以将 npm 库导入到 Deno 中。</li>
</ol>
<h3 id="1-%E5%A6%82%E4%BD%95%E5%AF%BC%E5%85%A5-deno-%E5%8E%9F%E7%94%9F%E5%BA%93">1. 如何导入 Deno 原生库<a class="anchor" href="#1-%E5%A6%82%E4%BD%95%E5%AF%BC%E5%85%A5-deno-%E5%8E%9F%E7%94%9F%E5%BA%93">§</a></h3>
<p>你可以直接通过 URL 导入 Deno 原生库。你也可以在这里这倒 Deno 库的列表：<a href="http://deno.land/x">deno.land/x</a>。</p>
<p>想要测试这个功能，让我们导入一个标准 Deno 日期格式库，然后在 React 页面中调用日期格式函数。在应用程序的 <code>pages</code> 文件夹中创建一个文件 <code>date-import.tsx</code>。在文件内部编写如下代码：</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token comment">// react 是 Aleph 中已经安装好的基础库</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token comment">// 从 URL 中导入其 format 函数</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> format <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"<a class="token url-link" href="https://deno.land/std@0.88.0/datetime/mod.ts">https://deno.land/std@0.88.0/datetime/mod.ts</a>"</span><span class="token punctuation">;</span>

<span class="token comment">// 将函数名称大写，以便将其识别为一个 React 组件</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">DateImport</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在这里，直接调用 format 函数可以正常使用</span>
  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span><span class="token plain-text">Hello all! Today is: </span><span class="token punctuation">{</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"dd-MM-yyyy"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>要查看此文件的输出，请跳转到 <a href="http://localhost:8080/date-import">localhost:8080/date-import</a>，你应该可以看到显示今天日期的页面。</p>
<h3 id="2-%E5%A6%82%E4%BD%95%E4%BB%8E-npm-%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%BA%93">2. 如何从 NPM 中导入库<a class="anchor" href="#2-%E5%A6%82%E4%BD%95%E4%BB%8E-npm-%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%BA%93">§</a></h3>
<p>要导入 npm 库，你也可以直接从 URL 导入——但在这种情况下，需要进行一些更改。自从我们讨论了 <a href="http://esm.sh/">esm.sh</a> 和 skypack.dev 以来，让我们尝试在实际中使用它们。此时，我们尝试在项目中导入 <a href="https://www.npmjs.com/package/dayjs">dayjs</a> 库。</p>
<blockquote>
<p>注意：并非所有 npm 库都可以在 Deno 中正常工作，因为它们可能依赖于特定于 Node 的功能。</p>
</blockquote>
<p>要在 <a href="http://esm.sh/">esm.sh</a> 中导入库，请将库的软件包名追加到 URL 后面。比如导入 dayjs 的话，我们可以导入 <code>[https://esm.sh/dayjs](https://esm.sh/dayjs)</code> 地址。这同时适用于你可能从库中导入的任何 CSS 文件。</p>
<p>现在，让我们在名为 <code>pages</code> 中创建一个文件 <code>dayjs-import.tsx</code>。因此，我们页面中的代码将如下所示：</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token comment">// react 是 Aleph 中已经安装好的基础库</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token comment">// 使用 esm.sh 导入 dayjs npm 库</span>
<span class="token keyword module">import</span> <span class="token imports">dayjs</span> <span class="token keyword module">from</span> <span class="token string">"<a class="token url-link" href="https://esm.sh/dayjs">https://esm.sh/dayjs</a>"</span><span class="token punctuation">;</span>

<span class="token comment">// 将函数名称大写，以便将其识别为一个 React 组件</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">DateImport</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 直接调用 dayjs 函数来显示今天的日期</span>
  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span><span class="token plain-text">Hello all! Today is: </span><span class="token punctuation">{</span><span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token string">"DD-MM-YYYY"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>要查看此文件的输出，打开 <a href="http://localhost:8080/dayjs-import">localhost:8080/dayjs-import</a>，你应该会看到显示当天日期的页面。</p>
<p>但在我们进行下一步之前，有一件重要的事——你如何导入 React 下的 <code>useState</code>、<code>useEffect</code> 等？幸运的是，Aleph 开发人员已经为我们编写了一个示例。</p>
<p>进入 <code>./lib/useCounter.ts</code>，你将找到在页面中用于计数器自定义钩子的代码。</p>
<p>由于我在本文中将重点介绍 Aleph 和 React 本身，因此，要查看在 Aleph 中导入 CSS文件的所有不同方法，请访问<a href="https://alephjs.org/docs/basic-features/built-in-css-support">官方文档中的相关页面</a>。</p>
<h2 id="%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-deno-%E5%92%8C-alephjs-%E6%9E%84%E5%BB%BA%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8">如何使用 Deno 和 AlephJS 构建示例应用<a class="anchor" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-deno-%E5%92%8C-alephjs-%E6%9E%84%E5%BB%BA%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8">§</a></h2>
<p>现在，让我们进入实战环境，来尝试自己在 Aleph 中构建一个 React 应用。我们将构建“Is It Down”，这是我使用现有的网站检查 API 制作的一个示例应用。这个应用将使我们能够检查一个网站当前是打开还是关闭的。</p>
<p>这是 CodeSandbox 链接：<a href="https://codesandbox.io/s/awesome-firefly-5dofg">https://codesandbox.io/s/awesome-firefly-5dofg</a></p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/86548/1619687189056-ae37faf6-7db8-4b4a-a7d5-27b8dad0292d.png#height=157&amp;id=RGlqP&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=157&amp;originWidth=707&amp;originalType=binary&amp;size=9891&amp;status=done&amp;style=none&amp;width=707" alt=""></p>
<p>构建此应用将向你展示如何使用 State hook、Effect Hook 以及如何在 Aleph 中进行 API 调用。</p>
<p>在 <code>pages</code> 文件夹中创建一个名为 <code>web-checker.tsx</code> 的新文件。让我们从仅添加 UI 元素开始。我们将显示一个带标题的 <code>h1</code> 元素，一个链接到 API 的 <code>h2</code> 元素以及一个接受用户输入的 form 元素。这是一个非交互式的页面，仅显示元素。</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontFamily<span class="token operator">:</span> <span class="token string">"sans-serif"</span><span class="token punctuation">,</span> textAlign<span class="token operator">:</span> <span class="token string">"center"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Is it Down?</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
        Go</span><span class="token punctuation">{</span><span class="token string">" "</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>
          <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><a class="token url-link" href="https://rapidapi.com/jakash1997/api/website-data-gathering-and-update-tracking">https://rapidapi.com/jakash1997/api/website-data-gathering-and-update-tracking</a><span class="token punctuation">"</span></span>
          <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          here
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token string">" "</span><span class="token punctuation">}</span><span class="token plain-text">
        to get an API key
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">

      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span>
        <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span>
        <span class="token punctuation">/></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Submit</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>接下来，为了捕获输入字段的状态，以及捕获我们必须进行的 API 调用的响应，让我们引入一下 state。</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token comment">// import useState from react</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// define both state variables</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>siteURL<span class="token punctuation">,</span> setUrl<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">,</span> setResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token spread operator">...</span>
</code></pre>
<p>现在，我们可以再输入元素中使用此状态，以便它可以对此作出响应：</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token spread operator">...</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
  <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>siteURL<span class="token punctuation">}</span></span>
  <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setUrl</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span>
<span class="token punctuation">/></span></span>
<span class="token spread operator">...</span>
</code></pre>
<p>当 API 返回响应时，我们还需要添加一些代码来显示响应：</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token spread operator">...</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
	
	

	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token spread operator">...</span>
</code></pre>
<p>现在，准备开始集成 API。让我们尝试正确的组合请求体。此时，API 是一个简单的 <code>GET</code> 调用，因此我们只需传递一个参数和一个 API 秘钥。</p>
<p>首先转到此处来生成 API 秘钥：<a href="https://rapidapi.com/jakash1997/api/website-data-gathering-and-update-tracking">https://rapidapi.com/jakash1997/api/website-data-gathering-and-update-tracking</a>。如下截图所示，找到密码并将其存储到安全的地方：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/86548/1619653831580-8df0a0a1-5c89-4c93-bfb1-d3d26136b93c.png#height=952&amp;id=Rfrkt&amp;originHeight=952&amp;originWidth=2000&amp;originalType=binary&amp;size=0&amp;status=done&amp;style=none&amp;width=2000" alt=""></p>
<p>接下来，让我们创建一个单独的函数 <code>sumitData</code>，用来生成所需的请求体。我们将使用 <code>axios</code> 库进行 GET 调用，同时用到 <code>options</code> 对象。</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token spread operator">...</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">,</span> setResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">submitData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">siteURL</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">setResponse</span><span class="token punctuation">(</span><span class="token string">"Loading..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token comment">// passing siteURL here through object shorthand</span>
    params<span class="token operator">:</span> <span class="token punctuation">{</span> siteURL <span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">// passing the required headers here</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">"x-rapidapi-key"</span><span class="token operator">:</span> <span class="token string">"YOUR_API_KEY"</span><span class="token punctuation">,</span>
      <span class="token string">"x-rapidapi-host"</span><span class="token operator">:</span>
        <span class="token string">"website-data-gathering-and-update-tracking.p.rapidapi.com"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// print options here</span>
	<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"options"</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
<span class="token spread operator">...</span>
</code></pre>
<p>然后，将其添加到表单的 <code>onSubmit</code> 函数中。</p>
<pre class="language-jsx"><code class="language-jsx">onSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">submitData</span><span class="token punctuation">(</span>siteURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre>
<p>现在，每当你点击 Submit 按钮时，你都能看到我们在控制台中生成的 <strong>options</strong>。如果你能看到，代表目前为止一切都正常！</p>
<p>接下来，我们只需执行简单的步骤，即使用 <a href="http://esm.sh/">http://esm.sh</a> 来导入 axios 库并使用它进行 API 调用。</p>
<p>在 <code>React</code> 导入之后，像这样导入 <code>axios</code>：</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">axios</span> <span class="token keyword module">from</span> <span class="token string">"<a class="token url-link" href="https://esm.sh/axios">https://esm.sh/axios</a>"</span><span class="token punctuation">;</span>

<span class="token spread operator">...</span>
</code></pre>
<p>并将其在 submitData 函数中使用：</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token spread operator">...</span>
	axios
    <span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
      <span class="token string">"<a class="token url-link" href="https://website-data-gathering-and-update-tracking.p.rapidapi.com/sitecheck">https://website-data-gathering-and-update-tracking.p.rapidapi.com/sitecheck</a>"</span><span class="token punctuation">,</span>
      options
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token spread operator">...</span>
</code></pre>
<p>就这么简单！尝试再次提交表单，这次你将在屏幕和控制台上都能看到正确的结果。</p>
<h2 id="%E7%BB%93%E8%AE%BA">结论<a class="anchor" href="#%E7%BB%93%E8%AE%BA">§</a></h2>
<p>现在你了解了 Aleph 的基础知识。这是一个非常有趣的工具，它使你可以将现有的 React 知识与 <a href="http://deno.land/">deno.land</a> 的前沿性和安全性结合。</p>
<p>如果你喜欢本教程，可以再 Twitter 上关注我 <a href="http://twitter.com/thewritingdev">@thewritingdev</a>。</p>
<blockquote>
<p>© <a href="https://github.com/hylerrix/deno-tutorial">https://github.com/hylerrix/deno-tutorial</a> 2020~2021</p>
</blockquote></article><div class="prev_next"><a class="prev button" href="/articles/translation/deno-url-shortener.html">«  <!-- -->如何在 Deno 中构建一个 URL 短链生成器</a><a class="next button" href="/articles/rust/index.html">Rust 篇<!-- -->  »</a></div><div id="gitalk-container"></div><link id="gitalk-css" rel="preload" href="https://cdn.pagic.org/gitalk@1.6.2/dist/gitalk.css" as="style"/><script defer="" src="https://cdn.pagic.org/gitalk@1.6.2/dist/gitalk.min.js"></script></div><div class="main_toc_container nav_link_container"><div class="main_toc"><aside><nav class="toc"><ol><li><a href="#%E5%A6%82%E4%BD%95%E4%BB%8E-alephjs-%E5%BC%80%E5%A7%8B">如何从 AlephJS 开始</a></li><li><a href="#%E5%A6%82%E4%BD%95%E5%9C%A8-deno-%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%BA%93">如何在 Deno 中导入库</a><ol><li><a href="#1-%E5%A6%82%E4%BD%95%E5%AF%BC%E5%85%A5-deno-%E5%8E%9F%E7%94%9F%E5%BA%93">1. 如何导入 Deno 原生库</a></li><li><a href="#2-%E5%A6%82%E4%BD%95%E4%BB%8E-npm-%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%BA%93">2. 如何从 NPM 中导入库</a></li></ol></li><li><a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-deno-%E5%92%8C-alephjs-%E6%9E%84%E5%BB%BA%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8">如何使用 Deno 和 AlephJS 构建示例应用</a></li><li><a href="#%E7%BB%93%E8%AE%BA">结论</a></li></ol></nav></aside></div></div></section><footer>Powered by <a href="https://github.com/xcatliu/pagic" target="_blank">Pagic</a></footer><div class="tools flex_center hide_on_mobile"><a class="czs-angle-up-l button" href="#" style="background-image:url(&quot;/assets/czs-angle-up-l.svg&quot;)"></a></div><script src="https://cdn.pagic.org/react@16.13.1/umd/react.production.min.js"></script><script src="https://cdn.pagic.org/react-dom@16.13.1/umd/react-dom.production.min.js"></script><script type="module" src="/index.js"></script></body></html>